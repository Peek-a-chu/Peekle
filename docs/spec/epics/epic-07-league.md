# Epic-10: 경쟁 참여자로서, 리그 시스템을 통해 경쟁하고 성장하고 싶다

## 📌 Overview
이 문서는 개인 리그 시스템을 다룹니다. 사용자들은 가입 시 리그를 배정받고, 매주 승급/강등을 통해 경쟁하며, 자신의 위치를 확인하여 동기부여를 얻을 수 있습니다.

## 📋 Stories

### S10-1. 리그 배정
🧾User Story

사용자로서, 서비스에 가입할 때 리그를 배정받고 싶다.

나의 실력에 맞는 그룹에서 경쟁을 시작하기 위함이다.

✅ Acceptance Criteria

 회원가입 시 초기 리그(예: Stone)를 배정한다.

 10명 단위의 리그 그룹에 사용자를 자동으로 할당한다.

**🛠 Implementation Tasks**
[ ] 회원가입 로직에 초기 리그 배정 추가
[ ] 리그 그룹 자동 할당 로직 구현 (그룹 인원 체크)

### S10-2. 주간 리그 업데이트
🧾User Story

시스템으로서, 매주 수요일 06:00마다 사용자의 리그를 이동시키고 점수를 초기화하고 싶다.

새로운 시즌을 시작하고 지속적인 경쟁 환경을 조성하기 위함이다.

✅ Acceptance Criteria

 매주 수요일 06:00에 배치 작업 실행 (기본 로직은 @Transactional 및 DB 사용).

 각 리그 그룹 내 순위에 따라 승급/강등/잔류 처리.

 **그룹 재분배**: 모든 사용자를 각 리그별로 수집(Redis 활용)한 후, 10명 단위로 무작위 그룹 매칭.

 **결과 확인**: 수요일 06:00 이후 접속한 유저에게 지난 주 리그 결과 모달을 띄우기 위해 `league_history.is_viewed` 필드를 확인한다.

 **소규모 그룹 예외 처리**:
   *   **1명 이하**: 변동 없음 (승급/강등 X).
   *   **2명 이상**: 최소 1명은 반드시 '유지' 상태가 되도록 보장한다.
       *   승급 인원 = MIN(CEIL(전체*P), 전체-1)
       *   강등 인원 = MIN(CEIL(전체*D), 전체-승급-1)

 **🛠 Implementation Tasks**
[ ] Spring Batch Job 설정 및 @Transactional 기반 승급/강등 로직
[ ] [Redis] 리그별 사용자 수집 및 10명 단위 그룹 재분배 구현
[ ] [DB] `league_history.is_viewed` 필드 추가 및 조회/갱신 로직 구현
[ ] 주간 점수 초기화 및 히스토리 저장

### S10-3. 리그 페이지 조회
🧾User Story

사용자로서, 리그 페이지에서 나의 현재 리그 현황을 보고 싶다.

내 순위, 점수, 승급/강등 가능성을 확인하여 목표를 설정하기 위함이다.

✅ Acceptance Criteria

 리그 페이지 진입 시 내 리그 정보와 랭킹 리스트를 표시한다.

 내 순위, 주간 점수, 최고 도달 리그(Max League) 정보를 보여준다.

 랭킹 리스트에서 승급권과 강등권을 시각적으로 구분한다.

**🛠 Implementation Tasks**
[x] `CCLeagueMyStatus` 컴포넌트 구현 (내 정보)
[x] `CCLeagueRankingList` 컴포넌트 구현 (랭킹 리스트)
[x] `/league` 페이지 레이아웃 구성
[ ] 실제 데이터 API 연동

### S10-4. 리그 정보 모달
🧾User Story

사용자로서, 리그 페이지에서 리그 시스템에 대한 상세 정보를 확인하고 싶다.

승급/강등 규칙과 각 리그의 특징(인원 분포 등)을 이해하기 위함이다.

✅ Acceptance Criteria

 도움말 아이콘 클릭 시 리그 정보 모달을 띄운다.

 전체 리그 티어 구조와 승급/강등 인원 규칙을 설명한다.

 각 리그의 현재 인원 분포를 퍼센트(%)로 표시한다.

**🛠 Implementation Tasks**
[ ] `LeagueInfoModal` 컴포넌트 구현
[ ] 리그 규칙 상수 데이터 시각화
[ ] [Backend] 리그별 인원 분포 조회로직 구현 (Redis/DB 통계)

