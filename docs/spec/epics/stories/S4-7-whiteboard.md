# S4-7. 화이트보드 시스템 (Overlay)

## 📌 Story Information
- **Epic**: Epic-04 (Study)
- **Story ID**: S4-7
- **Sprint**: TBD
- **Estimated Effort**: 3 days
- **Priority**: Medium
- **Dependencies**: Epic-03 (WebRTC)
- **Status**: Ready

---

## 🧾 User Story

**As a** 참여자
**I want to** 화이트보드를 열어 시각적으로 설명하고 싶다
**So that** 말로 설명하기 어려운 알고리즘이나 로직을 그림으로 공유하기 위함이다

---

## ✅ Acceptance Criteria

1. **미리보기**
   - 한 명이 화이트보드를 오픈하면, 비디오 그리드 왼쪽에 [미리보기 화면]이 생겨야 한다.

2. **오버레이 및 동기화**
   - 클릭 시 IDE 위에 [화이트보드 오버레이]가 열리고, 모든 참여자에게 드로잉이 실시간 동기화되어야 한다.

---

## 🎨 UI Specification

### 참조 와이어프레임
- [화이트보드 활성화 화면](../../../pics/스터디방%20화이트보드.svg)

### 화이트보드 활성화 흐름

1. **활성화 트리거**: 하단 Control Bar의 ✏️ 버튼 클릭
2. **알림**: Header 중앙에 알림 메시지 표시
3. **미리보기 타일**: 비디오 그리드 첫 번째에 화이트보드 미리보기 추가
4. **오버레이**: 미리보기 타일 클릭 시 IDE 영역에 화이트보드 오버레이 표시

### 비디오 그리드 - 화이트보드 타일
```
┌─────────────────────────────────────────────────────────────────┐
│ [화이트보드] [나(L)]  [참여자1]  [참여자2]  [...]                  │
│    (NEW!)                                                       │
└─────────────────────────────────────────────────────────────────┘
```

### 화이트보드 활성화 알림 (비디오 타일)
```
┌─────────────────────┐
│ 🟥 두둥!!!           │
│ 화이트보드가         │
│ 첫번째로 활성화      │
│ 됩니다~!!           │
├─────────────────────┤
│ 화이트보드           │
└─────────────────────┘
```
- 빨간 배경의 알림 배너가 화이트보드 타일 상단에 표시
- 첫 활성화 시 눈에 띄는 애니메이션 효과

### Header 알림 메시지
```
┌──────────────────────────────────────────────────────────────────┐
│ [←] [스터디명]        "참고하세요~!"        [👥 초대하기] [⚙️설정] │
└──────────────────────────────────────────────────────────────────┘
```
- 화이트보드 활성화 시 Header 중앙에 활성화한 사람의 메시지 표시

### 화이트보드 오버레이 (IDE 영역)
```
┌──────────────────────────────────────────────────────────────────┐
│                        화이트보드 Canvas                          │
│                                                                  │
│                                                                  │
│                         [손글씨/그림]                             │
│                           메 롱                                  │
│                                                                  │
│                                                                  │
│                                                                  │
├──────────────────────────────────────────────────────────────────┤
│ [✏️ 펜] [🔲 도형] [T 텍스트] [🗑 지우개] [↩️ 실행취소]    [X 닫기] │
└──────────────────────────────────────────────────────────────────┘
```

### 화이트보드 도구 상세
| 도구 | 기능 |
|------|------|
| **✏️ 펜** | 자유 드로잉 (색상, 굵기 선택 가능) |
| **🔲 도형** | 사각형, 원, 화살표 등 기본 도형 |
| **T 텍스트** | 텍스트 입력 |
| **🗑 지우개** | 그린 요소 삭제 |
| **↩️ 실행취소** | 마지막 작업 취소 |
| **X 닫기** | 화이트보드 오버레이 닫기 (내 화면만) |

### 상태 관리
| 상태 | 설명 |
|------|------|
| `isWhiteboardActive` | 화이트보드 세션 활성화 여부 (방 전체) |
| `whiteboardOpenedBy` | 화이트보드를 연 사람 정보 |
| `isOverlayOpen` | 현재 사용자의 오버레이 표시 여부 (개인) |
| `drawingData` | 실시간 동기화되는 드로잉 데이터 |

---

## 🛠 Implementation Tasks

- [ ] Canvas API 또는 화이트보드 라이브러리(Excalidraw/tldraw) 도입
- [ ] 화이트보드 미리보기 타일 컴포넌트 구현
- [ ] 화이트보드 오버레이 모달 UI 구현
- [ ] 도구 모음 (펜, 도형, 텍스트, 지우개, 실행취소) 구현
- [ ] WebSocket을 통한 드로잉 데이터 실시간 동기화
- [ ] 화이트보드 활성화 알림 (Header + 비디오 타일)
- [ ] 화이트보드 상태 관리 (`useWhiteboardStore`)
