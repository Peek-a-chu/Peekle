# S4-10. 참여자 관리 및 방장 권한 (Right Panel)

## 📌 Story Information

- **Epic**: Epic-04 (Study)
- **Story ID**: S4-10
- **Sprint**: TBD
- **Estimated Effort**: 1 day
- **Priority**: Medium
- **Dependencies**: Epic-03, Epic-04
- **Status**: Ready

---

## 🧾 User Story

**As a** 사용자(및 방장)
**I want to** 현재 참여 인원을 확인하고 방을 관리하고 싶다
**So that** 쾌적한 스터디 환경을 유지하기 위함이다

---

## ✅ Acceptance Criteria

1. **상태 표시**
   - 참여자 목록에 온라인/오프라인 상태가 표시되어야 한다. (현재 인원 수 표시)

2. **방장 권한**
   - 방장은 유저 강퇴, 권한 위임, 전체 음소거(Mute All) 기능을 사용할 수 있어야 한다.

---

## 🎨 UI Specification

### 참조 와이어프레임

- [스터디 룸 기본 레이아웃 (참여자 탭)](../../../pics/study_room_setup.svg)

### 참여자 탭 레이아웃

```
┌─────────────────────────────┐
│      [채팅]  [참여자 (3/4)]   │  ← 현재 온라인 / 전체 멤버 수
├─────────────────────────────┤
│ ┌─────────────────────────┐ │
│ │ 🟢 CodeNinja     👑      │ │  ← 온라인 + 방장 뱃지
│ │ [실시간 코드 확인]        │ │  ← 액션 버튼
│ └─────────────────────────┘ │
│                             │
│ ┌─────────────────────────┐ │
│ │ 🟢 알고마스터    (나)     │ │  ← 본인 표시
│ │                         │ │
│ └─────────────────────────┘ │
│                             │
│ ┌─────────────────────────┐ │
│ │ 🟢 PS러버        🔇      │ │  ← 음소거 상태
│ │ [실시간 코드 확인]        │ │
│ └─────────────────────────┘ │
│                             │
│ ┌─────────────────────────┐ │
│ │ ⚫ 백준킹                 │ │  ← 오프라인 (회색)
│ │                         │ │
│ └─────────────────────────┘ │
├─────────────────────────────┤
│ [🔇 전체 음소거] (방장 전용)  │  ← 방장만 노출
└─────────────────────────────┘
```

### 참여자 항목 상세

| 요소                   | 설명                                        |
| ---------------------- | ------------------------------------------- |
| **🟢 온라인 상태**     | 초록색 원 - 현재 스터디 룸에 접속 중        |
| **⚫ 오프라인 상태**   | 회색 원 - 스터디 멤버이지만 현재 미접속     |
| **👑 방장 뱃지**       | 방장인 경우 닉네임 옆에 표시                |
| **🔇 음소거 아이콘**   | 마이크 음소거 상태인 경우 표시              |
| **(나)**               | 본인인 경우 닉네임 옆에 표시                |
| **[실시간 코드 확인]** | 클릭 시 해당 유저의 실시간 코드 보기 (S4-8) |

### 참여자 카드 구조

```
┌─────────────────────────────────────────┐
│ 🟢 [프로필이미지] CodeNinja  👑 🔇       │
│                                         │
│ [실시간 코드 확인]  (방장: [강퇴] [위임]) │
└─────────────────────────────────────────┘
```

### 방장 전용 기능

**1. 참여자별 관리 메뉴 (방장만)**

```
┌─────────────────────────────┐
│ 🟢 PS러버              [⋮]  │  ← 더보기 메뉴 (방장에게만 표시)
│ [실시간 코드 확인]           │
└─────────────────────────────┘
         │
         ▼
┌─────────────────────────────┐
│ [👑 방장 위임]               │
│ [🚫 강퇴하기]                │
└─────────────────────────────┘
```

**2. 전체 음소거 버튼 (방장만)**

```
┌─────────────────────────────┐
│ [🔇 전체 음소거]             │  ← 클릭 시 모든 참여자 마이크 OFF
└─────────────────────────────┘
```

### 방장 권한 상세

| 기능            | API                                       | 설명                         |
| --------------- | ----------------------------------------- | ---------------------------- |
| **강퇴**        | `DELETE /api/study/{id}/members/{userId}` | 해당 유저를 스터디에서 제거  |
| **방장 위임**   | `PATCH /api/study/{id}/owner`             | 다른 유저에게 방장 권한 이전 |
| **전체 음소거** | WebSocket `MUTE_ALL`                      | 모든 참여자 마이크 OFF       |

### 강퇴 확인 모달

```
┌─────────────────────────────────────┐
│ 강퇴 확인                      [X]  │
├─────────────────────────────────────┤
│                                     │
│ PS러버님을 스터디에서 내보내시겠습니까? │
│                                     │
│ 강퇴된 유저는 다시 초대 코드로        │
│ 참여할 수 있습니다.                  │
│                                     │
├─────────────────────────────────────┤
│           [취소]    [강퇴하기]       │
└─────────────────────────────────────┘
```

### 방장 위임 확인 모달

```
┌─────────────────────────────────────┐
│ 방장 위임                      [X]  │
├─────────────────────────────────────┤
│                                     │
│ PS러버님에게 방장을 위임하시겠습니까?  │
│                                     │
│ 위임 후에는 방 설정 및 멤버 관리      │
│ 권한이 이전됩니다.                   │
│                                     │
├─────────────────────────────────────┤
│           [취소]    [위임하기]       │
└─────────────────────────────────────┘
```

### 실시간 이벤트 처리

| 이벤트          | 설명             | UI 변화                                 |
| --------------- | ---------------- | --------------------------------------- |
| `USER_JOIN`     | 유저 입장        | 참여자 목록에 추가, 온라인 상태로 표시  |
| `USER_LEAVE`    | 유저 퇴장        | 오프라인 상태로 변경 또는 목록에서 제거 |
| `USER_KICKED`   | 유저 강퇴        | 해당 유저 목록에서 제거                 |
| `OWNER_CHANGED` | 방장 변경        | 방장 뱃지 이동                          |
| `USER_MUTED`    | 음소거 상태 변경 | 🔇 아이콘 표시/숨김                     |

---

## 🛠 Implementation Tasks

- [ ] 참여자 탭 컴포넌트 구현 (Right Panel 탭 연동)
- [ ] 참여자 카드 컴포넌트 구현 (온라인 상태, 뱃지, 아이콘)
- [ ] "실시간 코드 확인" 버튼 클릭 핸들러 (S4-8 연동)
- [ ] 방장 전용 메뉴 구현 (강퇴, 위임)
- [ ] 전체 음소거 버튼 구현
- [ ] 강퇴/위임 확인 모달 구현
- [ ] 방장 권한 API 연동 (`KICK`, `TRANSFER_OWNER`, `MUTE_ALL`)
- [ ] WebSocket 이벤트 핸들러 구현 (`USER_JOIN`, `USER_LEAVE`, `USER_KICKED`, `OWNER_CHANGED`)
